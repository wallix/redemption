/*
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

   Product name: redemption, a FLOSS RDP proxy
   Copyright (C) Wallix 2013
   Author(s): Christophe Grosjean
*/

#include "test_only/test_framework/redemption_unit_tests.hpp"
#include "test_only/test_framework/sig.hpp"

#include "mod/vnc/encoder/pointer_loader_vnc.hpp"


RED_AUTO_TEST_CASE(TestVncPointer)
{
    uint16_t red_max = 31;
    uint16_t green_max = 63;
    uint16_t blue_max = 31;

    uint8_t red_shift = 11;
    uint8_t green_shift = 5;
    uint8_t blue_shift = 0;

    uint16_t sx = 4;
    uint16_t sy = 2;
    uint16_t cx = 18;
    uint16_t cy = 25;
    auto bytes_per_pixel = BytesPerPixel(2);

    uint8_t data[] = {
        /* 0000 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf3, 0x9c,
                   0xef, 0x7b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0010 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0020 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xdf, 0xff, 0xdf, 0xff, 0x38, 0xc6,
        /* 0030 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0040 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
        /* 0050 */ 0x55, 0xad, 0xdf, 0xff, 0x75, 0xad, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0060 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0070 */ 0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x75, 0xad,
                   0xde, 0xf7, 0xb2, 0x94, 0x00, 0x00, 0x00, 0x00,
        /* 0080 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0090 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
                   0x69, 0x4a, 0x69, 0x4a, 0xb6, 0xb5, 0xde, 0xf7,
        /* 00a0 */ 0x92, 0x94, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 00b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
        /* 00c0 */ 0x69, 0x4a, 0xf7, 0xbd, 0xbe, 0xf7, 0xae, 0x73,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 00d0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
        /* 00e0 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x8a, 0x52,
                   0x18, 0xc6, 0xbe, 0xf7, 0xaa, 0x52, 0x00, 0x00,
        /* 00f0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0100 */ 0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x8a, 0x52, 0x59, 0xce,
        /* 0110 */ 0xbe, 0xf7, 0x69, 0x4a, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0120 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 0130 */ 0x69, 0x4a, 0xaa, 0x52, 0x9a, 0xd6, 0xbe, 0xf7,
                   0xc7, 0x39, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0140 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
        /* 0150 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0xaa, 0x52, 0x9a, 0xd6, 0x9e, 0xf7, 0x00, 0x00,
        /* 0160 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
        /* 0170 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0xab, 0x5a,
        /* 0180 */ 0xdb, 0xde, 0x9e, 0xf7, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0190 */ 0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 01a0 */ 0x69, 0x4a, 0x69, 0x4a, 0xcb, 0x5a, 0x1b, 0xdf,
                   0x7d, 0xef, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 01b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 01c0 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0xeb, 0x5a, 0x1c, 0xe7, 0x7d, 0xef,
        /* 01d0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
        /* 01e0 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 01f0 */ 0xcf, 0x7b, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
        /* 0200 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 0210 */ 0x69, 0x4a, 0x0c, 0x63, 0x3c, 0xe7, 0x1b, 0xdf,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0220 */ 0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 0230 */ 0x69, 0x4a, 0x69, 0x4a, 0x0c, 0x63, 0x3c, 0xe7,
                   0xda, 0xd6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0240 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
                   0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 0250 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x5c, 0xe7, 0xba, 0xd6, 0x00, 0x00, 0x00, 0x00,
        /* 0260 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xff, 0xff, 0x69, 0x4a, 0x69, 0x4a,
        /* 0270 */ 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
                   0x69, 0x4a, 0x69, 0x4a, 0xff, 0xff, 0x00, 0x00,
        /* 0280 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xbe, 0xf7,
        /* 0290 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
                   0x55, 0xad, 0x69, 0x4a, 0x69, 0x4a, 0x69, 0x4a,
        /* 02a0 */ 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 02b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0xec, 0x62, 0xbe, 0xf7, 0x55, 0xad,
        /* 02c0 */ 0x69, 0x4a, 0x69, 0x4a, 0xff, 0xff, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 02d0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 02e0 */ 0x6d, 0x6b, 0xbe, 0xf7, 0x34, 0xa5, 0xcf, 0x7b,
                   0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 02f0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0300 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8e, 0x73,
                   0xbe, 0xf7, 0xbe, 0xf7, 0x59, 0xce, 0x00, 0x00,
        /* 0310 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0320 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0330 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0340 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0350 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0360 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0370 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0380 */ 0x00, 0x00, 0x00, 0x00,
    };

    uint8_t mask[] = {
        /* 0000 */ 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x1c, 0x00,
                   0x00, 0x1e, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x1f,
        /* 0010 */ 0x80, 0x00, 0x1f, 0xc0, 0x00, 0x1f, 0xe0, 0x00,
                   0x1f, 0xf0, 0x00, 0x1f, 0xf0, 0x00, 0x1f, 0xfc,
        /* 0020 */ 0x00, 0x1f, 0xfc, 0x00, 0x1f, 0xff, 0x00, 0x1f,
                   0xff, 0x00, 0x1f, 0xfe, 0x00, 0x1f, 0xfe, 0x00,
        /* 0030 */ 0x1f, 0xf8, 0x00, 0x1f, 0xf8, 0x00, 0x1f, 0xf8,
                   0x00, 0x00, 0xf8, 0x00, 0x00, 0x78, 0x00, 0x00,
        /* 0040 */ 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00,
    };

    VNC::PointerLoaderVnc pointer_loader_vnc;
    RdpPointerView cursor = pointer_loader_vnc.load(
        bytes_per_pixel,
        cx, cy, sx, sy,
        make_array_view(data),
        make_array_view(mask),
        red_shift, red_max,
        green_shift, green_max,
        blue_shift, blue_max);

    auto expected_data =
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x73\x71\x73\xf7\xf7"
        "\xf7\xf7\xf7\xf7\xce\xcb\xce\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x6b\x6d\x6b\xf7\xf7\xf7\xa5\xa6"
        "\xa5\x7b\x79\x7b\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x63\x5d\x63\xf7\xf7\xf7\xad\xaa\xad\x4a\x4d"
        "\x4a\x4a\x4d\x4a\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf7\xf7\xf7\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xad\xaa\xad\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\xe7\xeb\xe7\xd6\xd7\xd6\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\x63\x61\x63\xe7\xe7\xe7\xd6\xdb\xd6\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x63\x61\x63\xe7\xe7\xe7\xde\xe3\xde"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x7b\x79\x7b\xff\xff\xff"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x5a\x5d\x5a\xe7\xe3\xe7\xef\xef\xef"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x4a\x4d\x4a\x5a\x59\x5a\xde\xe3\xde\xef\xef\xef\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d"
        "\x4a\x5a\x55\x5a\xde\xdb\xde\xf7\xf3\xf7\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x52\x55"
        "\x52\xd6\xd3\xd6\xf7\xf3\xf7\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x52\x55\x52\xd6\xd3"
        "\xd6\xf7\xf7\xf7\x39\x38\x39\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x4a\x4d\x4a\x52\x51\x52\xce\xcb\xce\xf7\xf7"
        "\xf7\x4a\x4d\x4a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\x52\x51\x52\xc6\xc3\xc6\xf7\xf7\xf7\x52\x55"
        "\x52\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\x4a\x4d\x4a\xbd\xbe\xbd\xf7\xf7\xf7\x73\x75\x73\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\x4a"
        "\x4d\x4a\xb5\xb6\xb5\xf7\xfb\xf7\x94\x92\x94\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x4a\x4d\x4a\xad"
        "\xae\xad\xf7\xfb\xf7\x94\x96\x94\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xad\xaa\xad\xff"
        "\xfb\xff\xad\xae\xad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xfb\xff\xff\xfb\xff\xc6"
        "\xc7\xc6\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9c\x9e\x9c\x7b\x7d\x7b\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        ""_av_hex;
    RED_CHECK(cursor.xor_mask() == expected_data);

    auto expected_mask =
        "\xff\xff\xff\xff"
        "\xff\xff\xff\xff"
        "\xff\xff\xff\xff"
        "\xff\xc7\xff\xff"
        "\xff\x87\xff\xff"
        "\xff\x07\xff\xff"
        "\xe0\x07\xff\xff"
        "\xe0\x07\xff\xff"
        "\xe0\x07\xff\xff"
        "\xe0\x01\xff\xff"
        "\xe0\x01\xff\xff"
        "\xe0\x00\xff\xff"
        "\xe0\x00\xff\xff"
        "\xe0\x03\xff\xff"
        "\xe0\x03\xff\xff"
        "\xe0\x0f\xff\xff"
        "\xe0\x0f\xff\xff"
        "\xe0\x1f\xff\xff"
        "\xe0\x3f\xff\xff"
        "\xe0\x7f\xff\xff"
        "\xe0\xff\xff\xff"
        "\xe1\xff\xff\xff"
        "\xe3\xff\xff\xff"
        "\xe7\xff\xff\xff"
        "\xff\xff\xff\xff"
        ""_av;

    RED_CHECK(cursor.and_mask() == expected_mask);
}

RED_AUTO_TEST_CASE(TestPointerVNC_BW)
{
    uint8_t data[] = {
        /* 0000 */ 0x01, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0010 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00,
        /* 0020 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0030 */ 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0040 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00,
        /* 0050 */ 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0060 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0070 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        /* 0080 */ 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0090 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00,
        /* 00a0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        /* 00b0 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 00c0 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xdf, 0xff,
        /* 00d0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        /* 00e0 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x9e, 0xf7, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00,
        /* 00f0 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        /* 0100 */ 0xff, 0xff, 0x5d, 0xef, 0x02, 0x00, 0x22, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        /* 0110 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x1c, 0xe7, 0x02, 0x00,
        /* 0120 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xbe, 0xf7, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00,
        /* 0130 */ 0x02, 0x00, 0x02, 0x00, 0x02, 0x00, 0x02, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xbe, 0xf7,
        /* 0140 */ 0x01, 0x00, 0xb7, 0xb5, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0150 */ 0x01, 0x00, 0xff, 0xff, 0xbe, 0xf7, 0x01, 0x00, 0x22, 0x00, 0x01, 0x00, 0xff, 0xff, 0x1c, 0xe7,
        /* 0160 */ 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xbe, 0xf7, 0x01, 0x00, 0x22, 0x00,
        /* 0170 */ 0x00, 0x00, 0x02, 0x00, 0x19, 0xc6, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 0180 */ 0x02, 0x00, 0x01, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x22, 0x00, 0x01, 0x00, 0xff, 0xff,
        /* 0190 */ 0xbb, 0xd6, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 01a0 */ 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xbb, 0xd6, 0xff, 0xff, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
        /* 01b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x23, 0x00, 0x01, 0x00,
        /* 01c0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    uint8_t mask[] = {
        /* 0000 */ 0x80, 0x00,
                   0xc0, 0x00,
                   0xe0, 0x00,
                   0xf0, 0x00,
                   0xf8, 0x00,
                   0xfc, 0x00,
                   0xfe, 0x00,
                   0xff, 0x00,
        /* 0010 */ 0xff, 0x80,
                   0xff, 0xc0,
                   0xff, 0xe0,
                   0xff, 0xf0,
                   0xff, 0xb0,
                   0xff, 0x00,
                   0xf7, 0x80,
                   0xe7, 0x80,
        /* 0020 */ 0xc3, 0xc0,
                   0x03, 0xc0,
                   0x01, 0x00,
    };

    // r31 rs<<11 g63 gs<<5 b31 bs<<0

    VNC::PointerLoaderVnc pointer_loader_vnc;
    RdpPointerView vnccursor = pointer_loader_vnc.load(BytesPerPixel{2}, 12, 19, 0, 0,
        make_array_view(data), make_array_view(mask), 11, 31, 5, 63, 0, 31);

    RED_CHECK_EQUAL(vnccursor.dimensions().width, 32);
    RED_CHECK_EQUAL(vnccursor.dimensions().height, 19);
    RED_CHECK_EQUAL(vnccursor.hotspot().x, 0);
    RED_CHECK_EQUAL(vnccursor.hotspot().y, 0);

    auto expected_mask =
        "\xfe\xff\xFF\xFF"
        "\xfc\x3f\xFF\xFF"
        "\x3c\x3f\xFF\xFF"
        "\x18\x7f\xFF\xFF"
        "\x08\x7f\xFF\xFF"
        "\x00\xff\xFF\xFF"
        "\x00\x4f\xFF\xFF"
        "\x00\x0f\xFF\xFF"
        "\x00\x1f\xFF\xFF"
        "\x00\x3f\xFF\xFF"
        "\x00\x7f\xFF\xFF"
        "\x00\xff\xFF\xFF"
        "\x01\xff\xFF\xFF"
        "\x03\xff\xFF\xFF"
        "\x07\xff\xFF\xFF"
        "\x0f\xff\xFF\xFF"
        "\x1f\xff\xFF\xFF"
        "\x3f\xff\xFF\xFF"
        "\x7f\xff\xFF\xFF"
        ""_av_hex;
    RED_CHECK(vnccursor.and_mask() == expected_mask);

    auto expected_data =
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x04\x18\x00\x00\x08"
        "\x00\x00\x10\x00\x04\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x10\xd6\xd7\xde"
        "\xff\xff\xff\x00\x00\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x10\x00\x00\x08\x00\x04\x10\x00\x00\x00"
        "\x00\x00\x00\x00\x04\x10\x00\x00\x08\xff\xff\xff"
        "\xd6\xd7\xde\x00\x00\x08\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xf7\xf7\xf7\x00\x00\x08\x00\x04\x10"
        "\x00\x00\x00\x00\x00\x10\xc6\xc3\xce\xff\xff\xff"
        "\x00\x00\x10\x00\x04\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xf7\xf7\xf7\x00\x00\x08"
        "\x00\x04\x10\x00\x00\x08\xff\xff\xff\xe7\xe3\xe7"
        "\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xf7\xf7\xf7"
        "\x00\x00\x08\xb5\xb6\xbd\xff\xff\xff\x00\x00\x10"
        "\x00\x04\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xf7\xf7\xf7\xff\xff\xff\xff\xff\xff\x00\x00\x10"
        "\x00\x00\x10\x00\x00\x10\x00\x00\x10\x00\x00\x10"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xe7\xe3\xe7\x00\x00\x10"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xef\xeb\xef\x00\x00\x10\x00\x04\x10"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xf7\xf3\xf7\x00\x00\x10\x00\x04\x10\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xfb\xff"
        "\x00\x00\x10\x00\x04\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x10"
        "\x00\x04\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\xff\xff\xff\x00\x00\x10\x00\x04\x10"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\xff\xff\xff\x00\x00\x10\x00\x04\x10\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\xff\xff\xff"
        "\x00\x00\x10\x00\x04\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\xff\xff\xff\x00\x00\x10"
        "\x00\x04\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\xff\xff\xff\x00\x00\x10\x00\x04\x10"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\x00\x00\x10\x00\x04\x10\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

        "\x00\x00\x08\x00\x04\x10\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        ""_av_hex;
    RED_CHECK(vnccursor.xor_mask() == expected_data);
}

RED_AUTO_TEST_CASE(TestPointerVNC_Color)
{
    uint8_t data[] = {
        /* 0000 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 0010 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 0020 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0030 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 0040 */ 0x00, 0x00, 0x00, 0x00, 0x1a, 0x24, 0xbd, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbd, 0x2c,  // .....$.,.,.,.,.,
        /* 0050 */ 0x1a, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .$..............

        /* 0060 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0x1b,  // ..............U.
        /* 0070 */ 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .,.,.,.,.,.,.,.,
        /* 0080 */ 0xbe, 0x2c, 0x55, 0x1b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .,U.............

        /* 0090 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x58, 0x24, 0xde, 0x2c, 0xbe, 0x2c,  // ..........X$.,.,
        /* 00a0 */ 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .,.,.,.,.,.,.,.,
        /* 00b0 */ 0xbe, 0x2c, 0x55, 0x1b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .,U.............

        /* 00c0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0x26, 0x1f, 0x26, 0x1e, 0x2d, 0xbe, 0x2c,  // ........?&.&.-.,
        /* 00d0 */ 0xbe, 0x2c, 0x5b, 0x24, 0xb7, 0x23, 0x5b, 0x24, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .,[$.#[$.,.,.,.,
        /* 00e0 */ 0xbe, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .,..............

        /* 00f0 */ 0x00, 0x00, 0x00, 0x00, 0x7d, 0x25, 0x7f, 0x26, 0x7f, 0x26, 0x5f, 0x26, 0xdd, 0x24, 0x00, 0x00,  // ....}%.&.&_&.$..
        /* 0100 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x9d, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .........,.,.,.,
        /* 0110 */ 0x1a, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .$..............

        /* 0120 */ 0x00, 0x00, 0x1f, 0x26, 0x7f, 0x26, 0x7f, 0x26, 0x3f, 0x26, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ...&.&.&?&......
        /* 0130 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbd, 0x2c,  // .........,.,.,.,
        /* 0140 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0150 */ 0x7f, 0x26, 0x7f, 0x26, 0x7f, 0x26, 0x9e, 0x25, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .&.&.&.%........
        /* 0160 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x24, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0x00, 0x00,  // ......[$.,.,.,..
        /* 0170 */ 0x01, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x26,  // .."............&

        /* 0180 */ 0x7f, 0x26, 0x7f, 0x26, 0x1b, 0x25, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .&.&.%..........
        /* 0190 */ 0x00, 0x00, 0x00, 0x00, 0xb7, 0x23, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0x00, 0x00, 0x01, 0x00,  // .....#.,.,.,....
        /* 01a0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x26, 0x7f, 0x26,  // .."..........&.&

        /* 01b0 */ 0x7f, 0x26, 0xbe, 0x25, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .&.%............
        /* 01c0 */ 0x00, 0x00, 0x5b, 0x24, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff,  // ..[$.,.,.,......
        /* 01d0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x25, 0x3f, 0x26, 0x9f, 0x25,  // .."........%?&.%

        /* 01e0 */ 0xfe, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .,..............
        /* 01f0 */ 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbd, 0x2c, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff,  // .,.,.,.,........
        /* 0200 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7a, 0x24, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // ..".....z$.,.,.,

        /* 0210 */ 0x9d, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x9d, 0x2c, 0xbe, 0x2c,  // .,...........,.,
        /* 0220 */ 0xbe, 0x2c, 0xbe, 0x2c, 0x1a, 0x24, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,  // .,.,.$..........
        /* 0230 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .."......,.,.,.,

        /* 0240 */ 0xbe, 0x2c, 0x5b, 0x24, 0xb7, 0x23, 0x5b, 0x24, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .,[$.#[$.,.,.,.,
        /* 0250 */ 0xbe, 0x2c, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,  // .,..............
        /* 0260 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x55, 0x1b, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .."...U..,.,.,.,

        /* 0270 */ 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0x55, 0x1b,  // .,.,.,.,.,.,.,U.
        /* 0280 */ 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,  // ................
        /* 0290 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x55, 0x1b, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .."...U..,.,.,.,

        /* 02a0 */ 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c, 0x55, 0x1b, 0x00, 0x00, 0x00, 0x00,  // .,.,.,.,.,U.....
        /* 02b0 */ 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,  // ................
        /* 02c0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1a, 0x24, 0xbd, 0x2c, 0xbe, 0x2c, 0xbe, 0x2c,  // .."......$.,.,.,

        /* 02d0 */ 0xbe, 0x2c, 0xbd, 0x2c, 0x1a, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // .,.,.$..........
        /* 02e0 */ 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xdf, 0xff,  // ................
        /* 02f0 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ..".............

        /* 0300 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,  // ................
        /* 0310 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x9e, 0xf7,  // ................
        /* 0320 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ..".............

        /* 0330 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff,  // ................
        /* 0340 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x5d, 0xef,  // ..............].
        /* 0350 */ 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ..".............

        /* 0360 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff,  // ................
        /* 0370 */ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x1c, 0xe7,  // ................
        /* 0380 */ 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0390 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,  // ................
        /* 03a0 */ 0xbe, 0xf7, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0x02, 0x00, 0x02, 0x00, 0x02, 0x00, 0x02, 0x00,  // ................
        /* 03b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 03c0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0xbe, 0xf7, 0x01, 0x00,  // ................
        /* 03d0 */ 0xb7, 0xb5, 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ......".........
        /* 03e0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 03f0 */ 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0xbe, 0xf7, 0x01, 0x00, 0x22, 0x00, 0x01, 0x00,  // ............"...
        /* 0400 */ 0xff, 0xff, 0x1c, 0xe7, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 0410 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0420 */ 0x00, 0x00, 0x01, 0x00, 0xbe, 0xf7, 0x01, 0x00, 0x22, 0x00, 0x00, 0x00, 0x02, 0x00, 0x19, 0xc6,  // ........".......
        /* 0430 */ 0xff, 0xff, 0x02, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ...."...........
        /* 0440 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0450 */ 0x02, 0x00, 0x01, 0x00, 0x22, 0x00, 0x00, 0x00, 0x00, 0x00, 0x22, 0x00, 0x01, 0x00, 0xff, 0xff,  // ....".....".....
        /* 0460 */ 0xbb, 0xd6, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 0470 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 0480 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xbb, 0xd6, 0xff, 0xff,  // ................
        /* 0490 */ 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 04a0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................

        /* 04b0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x23, 0x00, 0x01, 0x00, 0x02, 0x00, 0x22, 0x00,  // ........#.....".
        /* 04c0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,  // ................
        /* 04d0 */ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,                                      // ..........
        };

    uint8_t mask[] = {
        /* 0000 */ 0b00000000, 0b00000000, 0b00000000,
                   0b00000000, 0b00001111, 0b11000000,
                   0b00000000, 0b00111111, 0b11100000,
                   0b00000000, 0b01111111, 0b11110000,
                   0b00000000, 0b11111010, 0b11111000,
                   0b00000001, 0b11110000, 0b01111100,
                   0b00000001, 0b11100000, 0b00111100,
                   0b00000001, 0b11100000, 0b00011100,
                   0b10000001, 0b11000000, 0b00011100,
                   0b11000001, 0b11100000, 0b00111100,
                   0b11100001, 0b11100000, 0b00111100,
                   0b11110001, 0b11110000, 0b01111000,
                   0b11111000, 0b11111101, 0b11111000,
                   0b11111100, 0b01111111, 0b11110000,
                   0b11111110, 0b00111111, 0b11100000,
                   0b11111111, 0b00001111, 0b10000000,
                   0b11111111, 0b10000000, 0b00000000,
                   0b11111111, 0b11000000, 0b00000000,
                   0b11111111, 0b11100000, 0b00000000,
                   0b11111111, 0b11110000, 0b00000000,
                   0b11111111, 0b11010000, 0b00000000,
                   0b11111111, 0b00000000, 0b00000000,
                   0b11110111, 0b10000000, 0b00000000,
                   0b11100111, 0b10000000, 0b00000000,
                   0b11000011, 0b11000000, 0b00000000,
                   0b00000011, 0b11000000, 0b00000000,
                   0b00000001, 0b00000000, 0b00000000,
    };

    VNC::PointerLoaderVnc pointer_loader_vnc;
    RdpPointerView vnccursor = pointer_loader_vnc.load(BytesPerPixel{2}, 23, 27, 0, 8,
        make_array_view(data), make_array_view(mask), 11, 31, 5, 63, 0, 31);

    // When cursor Size is odd, then the next even width is used and mask is fixed accordingly to avoid some annoying border cases
    RED_CHECK_EQUAL(vnccursor.dimensions().width, 32);
    RED_CHECK_EQUAL(vnccursor.dimensions().height, 27);
    RED_CHECK_EQUAL(vnccursor.hotspot().x, 0);
    RED_CHECK_EQUAL(vnccursor.hotspot().y, 8);
    auto d = vnccursor.xor_mask();
    auto m = vnccursor.and_mask();

    RED_CHECK_EQUAL(m.size(), 27*4);
    RED_CHECK_SIG(m,
        "\x3f\x6d\x9a\xdb\x5b\xa6\xe4\xa0\x68\x31\x1c\x75\x9f\xd4\xba\xc5\x87\xb1\x33\x0f");

    RED_CHECK_EQUAL(d.size(), 32 * 3 * 27);
    RED_CHECK_SIG(d,
        "\x43\xe7\x94\xd7\xa9\xe8\xa6\xb6\x94\xc9\x32\xfa\xf8\xc4\x91\x50\xa4\x06\xac\xad");
}
